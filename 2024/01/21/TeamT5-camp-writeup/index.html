<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="robots" content="index, follow"><title>TeamT5 camp writeup • ShallowFeather Blog</title><meta name="description" content="TeamT5 camp writeup - ShallowFeather"><link rel="icon" href="/favicon.svg"><link rel="stylesheet" href="https://unpkg.com/nanoreset@3.0.1/nanoreset.min.css"><link rel="stylesheet" href="/css/theme.css"><link rel="search" type="application/opensearchdescription+xml" href="/atom.xml" title="ShallowFeather Blog"><meta name="generator" content="Hexo 7.1.0"><link rel="alternate" href="/atom.xml" title="ShallowFeather Blog" type="application/atom+xml">
</head><body><div class="wrap" id="barba-wrapper"><header><h1 class="branding"><a href="/" title="ShallowFeather Blog">ShallowFeather Blog</a></h1><ul class="nav nav-list"><li class="nav-list-item"><a class="nav-list-link no-barba" href="/" target="_self">HOME</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/about" target="_self">ABOUT</a></li><li class="nav-list-item"><a class="nav-list-link no-barba" href="/archives" target="_self">ARCHIVES</a></li><li class="nav-list-item"></ul></header><div class="barba-container"><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">TeamT5 camp writeup</h1><div class="post-info"><a></a>2024-01-21</div><div class="post-content"><h2 id="類別三：遊戲外掛實作"><a href="#類別三：遊戲外掛實作" class="headerlink" title="類別三：遊戲外掛實作"></a>類別三：遊戲外掛實作</h2><h3 id="基礎題-40-50"><a href="#基礎題-40-50" class="headerlink" title="基礎題 (40% ~ 50%)"></a>基礎題 (40% ~ 50%)</h3><h4 id="控制炸彈數"><a href="#控制炸彈數" class="headerlink" title="控制炸彈數"></a>控制炸彈數</h4><p>通過 Cheat Engine 去搜尋初始值<br>一開始炸彈數量一定是 1 那吃了道具後會加 1 死掉則變回 1 由此慢慢測試<br><img src="https://hackmd.io/_uploads/B1Yk4ycVT.png" alt="image"></p>
<h4 id="控制火力"><a href="#控制火力" class="headerlink" title="控制火力"></a>控制火力</h4><p>通過 Cheat Engine 去搜尋初始值<br>一開始炸彈數量一定是 1 那吃了道具後會加 1 死掉則變回 1 由此慢慢測試<br>哈哈跟上面一樣<br><img src="https://hackmd.io/_uploads/HkQL4J9V6.png" alt="image"></p>
<h4 id="控制走路速度"><a href="#控制走路速度" class="headerlink" title="控制走路速度"></a>控制走路速度</h4><p>走路速度一開始搜尋 1 時沒有找到 之後用尋找遞增的方式去尋找<br>發現他初始值是 2 原本才找不到<br><img src="https://hackmd.io/_uploads/ByhHUkq4a.png" alt="image"></p>
<h4 id="永久盾牌"><a href="#永久盾牌" class="headerlink" title="永久盾牌"></a>永久盾牌</h4><p>盾牌的話 會有一個 0 或 1 決定是否啟動<br>並且如果他計時為 0 時也會取消掉<br><img src="https://hackmd.io/_uploads/r1ZOOJ5Va.png" alt="image"></p>
<h4 id="extra-昏迷"><a href="#extra-昏迷" class="headerlink" title="extra 昏迷"></a>extra 昏迷</h4><p>跟盾牌一樣的道理 我在她 struct 發現的 就想說加在這邊<br><img src="https://hackmd.io/_uploads/SJ4EK15NT.png" alt="image"></p>
<h3 id="進階題-50-60"><a href="#進階題-50-60" class="headerlink" title="進階題 (50% ~ 60%)"></a>進階題 (50% ~ 60%)</h3><h4 id="倒數時間暫停"><a href="#倒數時間暫停" class="headerlink" title="倒數時間暫停"></a>倒數時間暫停</h4><p>這個我覺得比下面穿牆的還難一點<br>原本想說用 Cheat Engine 找到時間的總和但是發現他好像是 call SDL 的 tick 來確認時間 (?<br>所以我就從 ghidra 那邊看有 call tick 的<br><img src="https://hackmd.io/_uploads/SJuFsk94p.png" alt="image"><br>最後發現這邊<br><img src="https://hackmd.io/_uploads/S1zCjk9Ea.png" alt="image"><br>把 sub 的指令全部改成 nop 也就是 0x90 後就能夠讓他時間取消計時了</p>
<h4 id="穿牆"><a href="#穿牆" class="headerlink" title="穿牆"></a>穿牆</h4><p>先利用 Cheat Engine 把腳色的 x y 找出來<br>我就直接猜說 他會在更動 x y 時 去檢查是否有超出邊界<br><img src="https://hackmd.io/_uploads/Hkfd2kqVT.png" alt="image"><br>最後發現把上面CrazyArcade.exe+38A4 位置的指令改成 nop 就不會檢查了</p>
<h4 id="用游標移動角色"><a href="#用游標移動角色" class="headerlink" title="用游標移動角色"></a>用游標移動角色</h4><p>下面兩個則不能直接用 Cheat engine 去用了 必須要 inject dll 才行<br>然後我原本想法是利用 SDL2 的函數去抓滑鼠的位置 然後再改 x y<br>但後面發現要 getmodule 之類的好麻煩 乾脆用 windows.h 的內建函數解決<br><img src="https://hackmd.io/_uploads/B1bxCkc4T.png" alt="image"><br>減掉 rect.left 跟 rect.top 是因為他不是全螢幕 所以視窗會跟著它移動<br>-40 是為了讓他更接近滑鼠 不然 windows.h 是由視窗左上角去做定位的</p>
<h4 id="用滑鼠左鍵放炸彈"><a href="#用滑鼠左鍵放炸彈" class="headerlink" title="用滑鼠左鍵放炸彈"></a>用滑鼠左鍵放炸彈</h4><p>這個部份我逆向比較久<br>基本把所有邏輯都拆光了吧 (?<br>原本想說 他一定是對應某個案件然後去call 放炸彈<br>所以把call的案件code修改就能成功了<br>沒想到她還有其他檢查就很頭痛 而且我也不知道滑鼠對應的數字 還要找就很麻煩<br><img src="https://hackmd.io/_uploads/Hyi7JgcNT.png" alt="image"><br>所以最後就只能通過注入 然後去呼叫它裡面寫好的 function<br>param_2 就是他的遊戲腳色 struct<br>所以要做的只有 攔截滑鼠按鍵 + 呼叫 function<br><img src="https://hackmd.io/_uploads/B1WnklcNa.png" alt="image"><br>然後 在 dll 中 我是去開兩個 thread 來處理所有操作</p>
<h3 id="Kernel-題-10-20"><a href="#Kernel-題-10-20" class="headerlink" title="Kernel 題 (10% ~ 20%)"></a>Kernel 題 (10% ~ 20%)</h3><p>題外話，都用 RTcore 這個 driver ㄟ 害我原本工具加載上去發現沒辦法在開啟遊戲 原來是這個在搞<br>建議使用 Windows 1909 就是為了能打這個 driver 對ㄅ</p>
<h4 id="破解遊戲保護"><a href="#破解遊戲保護" class="headerlink" title="破解遊戲保護"></a>破解遊戲保護</h4><p>ObRegisterCallbacks 上網查一下發現是註冊某個 process 到註冊表中，並讓其他東西存取他時會讀取不到<br>那搜尋時我也發現有 ObUnRegisterCallbacks 這個 function 也就是用來將他從註冊表中移除<br>因此如果要破解遊戲保護的話 就只要找到 ObUnRegisterCallbacks 這個函數的相關參數就可以了<br>反正就是 他加入註冊表後會加入他的 linklist 也就是說 我從中抓取一個 並且遍歷他找到應該要解除了 或是直接把全部 linklist 上的都去 call ObUnRegisterCallbacks 不就解決了嗎<br>如果遍歷找他的話應該可以用她的 Altitude 的值去找<br><img src="https://hackmd.io/_uploads/HkqIMg9E6.png" alt="image"></p>
</div></article></div></main><footer><div class="paginator"><a class="prev" href="/2024/01/21/AIS3-Pre-Exam-2023-writeup/">prev</a><a class="next" href="/2024/01/21/TeamT5-%E9%87%A3%E9%AD%9A%E9%81%8A%E6%88%B2-WriteUp/">next</a></div><div class="copyright"><p>&copy; 2023 - 2024 <a target="_blank" rel="noopener" href="https://github.com/shallowfeather">ShallowFeather</a><br>Powered by <a href="https://hexo.io/" rel="noreferrer" target="_blank">Hexo</a></p></div></footer></div></div><script>var _gaq = _gaq || [];
_gaq.push(['_setAccount', 'G-R3NRYM6M1V']);
_gaq.push(['_trackPageview']);

(function () {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
})();</script><script src="https://cdnjs.cloudflare.com/ajax/libs/barba.js/1.0.0/barba.min.js"></script><script>document.addEventListener('DOMContentLoaded', function() {
    Barba.Pjax.start()
})</script></body></html>